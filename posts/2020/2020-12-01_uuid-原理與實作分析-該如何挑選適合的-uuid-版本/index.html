<!DOCTYPE html>
<html lang="en"><head>
	
	<meta name="generator" content="Hugo 0.81.0" />
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="æ–¯æ–¯æœ‰å¥½å¹¾ç¨®ï¼ŒUUID ç¸½å…±æœ‰ v1~v5ï¼Œæœ¬ç¯‡å°‡å¾ RFC æ–‡ä»¶é–‹å§‹ï¼Œä¸¦ä»‹ç´¹ js ä¸­ uuid çš„å¯¦ä½œæ–¹å¼ï¼Œå¹«åŠ©å¤§å®¶æ‰¾åˆ°é©åˆçš„ UUID æ–¹æ¡ˆ"><meta property="og:title" content="UUID åŸç†èˆ‡å¯¦ä½œåˆ†æ - è©²å¦‚ä½•æŒ‘é¸é©åˆçš„ UUID ç‰ˆæœ¬" />
<meta property="og:description" content="æ–¯æ–¯æœ‰å¥½å¹¾ç¨®ï¼ŒUUID ç¸½å…±æœ‰ v1~v5ï¼Œæœ¬ç¯‡å°‡å¾ RFC æ–‡ä»¶é–‹å§‹ï¼Œä¸¦ä»‹ç´¹ js ä¸­ uuid çš„å¯¦ä½œæ–¹å¼ï¼Œå¹«åŠ©å¤§å®¶æ‰¾åˆ°é©åˆçš„ UUID æ–¹æ¡ˆ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuanchieh.page/posts/2020/2020-12-01_uuid-%E5%8E%9F%E7%90%86%E8%88%87%E5%AF%A6%E4%BD%9C%E5%88%86%E6%9E%90-%E8%A9%B2%E5%A6%82%E4%BD%95%E6%8C%91%E9%81%B8%E9%81%A9%E5%90%88%E7%9A%84-uuid-%E7%89%88%E6%9C%AC/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-01T08:21:40&#43;00:00" />
<meta property="article:modified_time" content="2020-12-01T08:21:40&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="UUID åŸç†èˆ‡å¯¦ä½œåˆ†æ - è©²å¦‚ä½•æŒ‘é¸é©åˆçš„ UUID ç‰ˆæœ¬"/>
<meta name="twitter:description" content="æ–¯æ–¯æœ‰å¥½å¹¾ç¨®ï¼ŒUUID ç¸½å…±æœ‰ v1~v5ï¼Œæœ¬ç¯‡å°‡å¾ RFC æ–‡ä»¶é–‹å§‹ï¼Œä¸¦ä»‹ç´¹ js ä¸­ uuid çš„å¯¦ä½œæ–¹å¼ï¼Œå¹«åŠ©å¤§å®¶æ‰¾åˆ°é©åˆçš„ UUID æ–¹æ¡ˆ"/>

	<link rel="stylesheet" type="text/css" media="screen" href="/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="/css/all.css" />
	<title>UUID åŸç†èˆ‡å¯¦ä½œåˆ†æ - è©²å¦‚ä½•æŒ‘é¸é©åˆçš„ UUID ç‰ˆæœ¬ | Yuanchieh&#39;s Blog</title><meta name="google-site-verification" content="Zmi0DCwmB_paCE45T_J552m4NDDpaMH6dqZLMYgM7Js" />
</head>
<body><header>
	
	<div id="avatar">
		<a href="https://yuanchieh.page">
		  <img src="https://avatars0.githubusercontent.com/u/6858460?s=460&amp;v=4" alt="Yuanchieh&#39;s Blog">
		</a>
	</div>
	
	<div id="titletext"><h2 id="title"><a href="https://yuanchieh.page">Yuanchieh&#39;s Blog</a></h2></div>
	<div id="title-description"><p id="subtitle">ç”Ÿå‘½æ˜¯é•·æœŸè€ŒæŒçºŒçš„ç´¯ç©</p><div id="social">
			<nav>
				<ul>
					<li><a href="https://github.com/sj82516"><i title="Github" class="icons fab fa-github"></i></a></li><li><a href="mailto:sj82516@gmail.com"><i title="Email" class="icons fas fa-envelope"></i></a></li>
					<li><a href="/index.xml"><i title="RSS" class="icons fas fa-rss"></i></a></li></ul>
			</nav>
		</div>
	</div>
	
	<div id="mainmenu">
		<nav>
			<ul>
				
				<li><a href="/posts">All Posts</a></li>
				
				<li><a href="/about">About</a></li>
				
				<li><a href="/categories">Categories</a></li>
				
			</ul>
		</nav>
	</div>
	
</header>
<main><div class="post">
	
	<div class="author">
	
	</div>
	<div class="post-header">
	
		<div class="meta">
			
			<div class="date">
				<span class="day">01</span>
				<span class="rest">Dec 2020</span>
			</div>
			
		</div>
		
		<div class="matter">
			<h1 class="title">UUID åŸç†èˆ‡å¯¦ä½œåˆ†æ - è©²å¦‚ä½•æŒ‘é¸é©åˆçš„ UUID ç‰ˆæœ¬</h1>
		</div>
	</div>
	<div class="markdown">
		<p>UUID æ˜¯ä¸€å€‹è¢«å¤§é‡ä½¿ç”¨çš„æ¼”ç®—æ³•ï¼Œåˆ†æ•£å¼åœ°ç”¢ç”Ÿå¤§é‡<code>ä¸é‡è¤‡ä¸”å›ºå®šç‚º 128 bit</code>çš„ IDï¼Œåˆ†æ•£å¼æ˜¯æŒ‡èªªå¤šå°æ©Ÿå™¨æ¯ç§’åŒæ™‚ç”¢ç”Ÿå¤šç­† UUIDï¼Œæœ‰æ¥µå¤§æ¦‚ç‡é€™äº› UUID éƒ½ä¸æœƒç™¼ç”Ÿé‡è¤‡ï¼Œä¸éœ€è¦æœ‰ä¸€å°æ©Ÿå™¨å±…ä¸­è² è²¬ ID çš„ç®¡æ§èˆ‡ç™¼æ”¾ï¼Œåä¾‹åƒæ˜¯ MySQL è³‡æ–™åº«ä¸­çš„ auto increment id</p>
<p>å…ˆæé‡é»ï¼Œå¦‚ä½•é¸æ“‡ UUID v1 ~ v5ï¼Œåƒè€ƒ <a href="https://stackoverflow.com/questions/20342058/which-uuid-version-to-use">Which UUID version to use?</a></p>
<ol>
<li><strong>v4</strong>: å®Œå…¨éš¨æ©Ÿï¼Œæ²’æœ‰ç‰¹æ®Šéœ€æ±‚é¸é€™å€‹ï¼Œæ ¹æ“š uuid.js çµ±è¨ˆæœ‰ <code>77%</code> ç”¨æˆ¶é¸æ“‡é€™å€‹</li>
<li><strong>v1</strong>: çµ„æˆåŒ…å« timestamp èˆ‡æ©Ÿå™¨è­˜åˆ¥ç¢¼(MAC Address)ï¼Œå¦‚æœéœ€è¦è­˜åˆ¥ç”±å“ªä¸€å°æ©Ÿå™¨åœ¨ä»€éº¼æ™‚é–“é»ç”¢ç”Ÿå¯ä»¥é¸é€™å€‹ï¼Œæ ¹æ“š uuid.js çµ±è¨ˆæœ‰ <code>21%</code> ç”¨æˆ¶é¸æ“‡é€™å€‹</li>
<li><strong>v5 &amp; v3</strong>: å¯ä»¥æŒ‡å®š Namespace èˆ‡ Nameï¼Œç›¸åŒçš„ Namespace èˆ‡ Name æœƒç”¢ç”Ÿç›¸åŒçš„ UUIDï¼Œv3 é›·åŒ v5ï¼Œå·®åˆ¥åœ¨æ–¼ v5 æœƒæ¡ç”¨ SHA1 ç•¶ä½œ Hash function è€Œ v3 æ¡ç”¨ MD5ï¼Œé™¤äº†ç›¸å®¹æ€§ç­‰è€ƒé‡ï¼Œå¦å‰‡è«‹å„ªå…ˆæ¡ç”¨ v5ï¼Œæ ¹æ“š uuid.js çµ±è¨ˆæœ‰ <code>1%</code> ç”¨æˆ¶é¸æ“‡é€™å€‹</li>
<li><strong>v2</strong>: ä¸æ¡ç”¨ï¼Œé€£ RFC æ–‡ä»¶ä¹Ÿåªæœ‰å¸¶åˆ°å®šç¾©ï¼Œæ²’æœ‰å¯¦ä½œè¦ç¯„</li>
</ol>
<p>éœ€è¦ç‰¹åˆ¥æ³¨æ„ï¼Œå¦‚æœæ˜¯ä½¿ç”¨ <a href="https://github.com/uuidjs/uuid">uuid.js</a> çš„ v1ï¼Œuuid å¯¦ä½œæ˜¯æ²’æœ‰æ¡ç”¨ MAC Addressï¼Œæ‰€ä»¥å¦‚æœæœ‰è­˜åˆ¥åŒä¸€å°æ©Ÿå™¨ç”¢ç”Ÿçš„ uuid çš„éœ€æ±‚ï¼Œéœ€è¦è‡ªå·±å¦å¤–å¯¦ä½œï¼Œå¾Œé¢æœ‰æ›´è©³ç›¡çš„è£œå……</p>
<p>ä»¥ä¸‹å°‡æ‘˜è¦ <a href="https://tools.ietf.org/html/rfc4122">RFC 4122 - A Universally Unique IDentifier (UUID) URN Namespace </a>ï¼Œä¸¦æ¯”å°æ¯é€±æœ‰å°‡è¿‘å››ç™¾è¬ä¸‹è¼‰çš„ uuid.js å¯¦ä½œï¼Œæœ‰è©¢å•ä½œè€…ä¸€äº›ç´°ç¯€ï¼Œä»–ä¹Ÿéå¸¸ç†±å¿ƒè£œå……å¾ˆå¤šæœ‰æ£’çš„è³‡æ–™ï¼Œæœƒä¸€ä¸¦æ•´ç†åˆ†äº«</p>
<h2 id="rfc-4122">RFC 4122</h2>
<p>UUID å…±æœ‰ 128 bitsï¼Œä»¥ä¸‹æ˜¯ v1 å¯¦ä½œè¦ç¯„</p>
<h3 id="412--layout-and-byte-order">4.1.2.  Layout and Byte Order</h3>
<p><img src="/posts/img/20201201/uuid.png" alt=""><br>
ä»¥ä¸‹å°‡ä»‹ç´¹æ¯å€‹æ¬„ä½çš„çµ„æˆ</p>
<h3 id="413--version">4.1.3.  Version</h3>
<p>UUID ç‰ˆæœ¬å¤¾åœ¨ time_hi_and_version æœ€é«˜æ•ˆä½å…ƒ(most significant)ä¸­ 4~7 bitï¼Œæ‰€ä»¥å¾ UUID string å°±èƒ½çœ‹å‡ºç‰ˆè™Ÿ</p>
<h3 id="414--timestamp">4.1.4.  Timestamp</h3>
<p>Timestamp ç¸½å…±æ˜¯ 60 bitsï¼Œå°æ–¼ UUID v1 ä¾†èªªæ˜¯ UTC æ™‚é–“ä¸”è‡ª 1582/10/15 00:00:00 (the date of Gregorian reform to the Christian calendar) é–‹å§‹è¨ˆç®—ï¼Œå¦‚æœæ©Ÿå™¨æ²’æœ‰ UTC æ™‚é–“ï¼Œå¯ä»¥æ¡ç”¨ local timeï¼Œä½†æ˜¯è¦ç¢ºä¿ local time æ˜¯ç©©å®šçš„</p>
<h3 id="415--clock-sequence">4.1.5.  Clock Sequence</h3>
<p>å¦‚æœç³»çµ±æ™‚é–“ç™¼ç”Ÿå€’è½‰ï¼Œæˆ–æ˜¯ Node ID ç™¼ç”Ÿæ”¹è®Šï¼Œå‰‡æœƒå¢åŠ ç¢°æ’çš„å¯èƒ½æ€§ï¼Œæ‰€ä»¥é€é Clock Sequence ä¾†ç´€éŒ„ï¼Œå¦‚æœç™¼ç¾ç”¢ç”Ÿéçš„ UUID æ¡ç”¨çš„ Timestamp æ¯”ç•¶ä¸‹çš„æ™‚é–“é‚„è¦æ™šæ™‚ (æ„å³ Clock æ™‚é–“è¢«å€’è½‰)ï¼Œå‰‡ clock sequence éå¢ï¼Œåˆå§‹åŒ–å‰‡éš¨æ©Ÿç”¢ç”Ÿ</p>
<p>å¦å¤–å¦‚æœ Node ID ç™¼ç”Ÿæ”¹è®Šï¼Œé‚£æœ€å¥½ä¹Ÿå°‡ clock sequence éš¨æ©Ÿé‡ç½®ï¼Œé™ä½ç¢°æ’çš„é¢¨éšª</p>
<p>éœ€æ³¨æ„ clock sequence çš„è¨­å®šæœ€å¥½æ˜¯åœ¨ç³»çµ±å•Ÿå‹•å¾Œè¨­å®šä¸€æ¬¡å°±ä¸è¦å†æ”¹è®Šï¼Œé™ä½è·¨ç³»çµ±ç”¢ç”Ÿç¢°æ’çš„é¢¨éšª</p>
<h3 id="416--node">4.1.6.  Node</h3>
<p>Node ID æ¡ç”¨ <code>IEEE 802 MAC address</code>ï¼Œå¦‚æœæœ‰å¤šå€‹ MAC Address ä»»ä¸€æŒ‘ä¸€å€‹æœ‰ç”¨çš„å³å¯ï¼Œå¦‚æœæ²’æœ‰å‰‡éš¨æ©Ÿç”¢ç”Ÿ</p>
<p>ä»¥ä¸Šæ˜¯ v1 çš„æ¬„ä½æ„ç¾©ï¼Œv3ã€v5 å‰‡æ˜¯æŠŠ Name åŠ ä¸Š Namespace å–é›œæ¹Šï¼Œæ¥è‘—åˆ†é…è‡³ä¸Šè¿°çš„æ¬„ä½ä¸­ï¼Œv4 å‰‡å…¨éƒ¨éš¨æ©Ÿç”¢ç”Ÿ</p>
<h3 id="421--basic-algorithm">4.2.1.  Basic Algorithm</h3>
<p>æ¥è‘—çœ‹æœ€åŸºæœ¬çš„æ¼”ç®—æ³•å¯¦ä½œæµç¨‹</p>
<ol>
<li>å–å¾—ç³»çµ±ç´šåˆ¥çš„å…¨åŸŸé–</li>
<li>è®€å–ç³»çµ±è¨­å®šæª”ï¼ŒåŒ…å« clock_seq / node id / timestamp</li>
<li>è¨ˆç®—å‡º timestamp</li>
<li>å–å¾— node id</li>
<li>å¦‚æœä¿å­˜ node id èˆ‡è®€å–çš„ node id ä¸åŒï¼Œé‡æ–°è¨­å®š clock_seq</li>
<li>ç•¶å‰ timestamp å°æ–¼ä¿å­˜çš„ timestampï¼Œclock_seq + 1</li>
<li>å°‡ç›®å‰è¨ˆç®—çš„å€¼ä¿å­˜å›å»</li>
<li>é‡‹æ”¾é–</li>
<li>å°‡ç›®å‰çš„ timestamp / clock_seq / node id çµ„åˆå‡º uuid</li>
</ol>
<p>å¦‚æœè¦é«˜é »ç‡è£½é€  uuidï¼Œæœƒé‡åˆ°ä»¥ä¸‹å¹¾å€‹æ•ˆèƒ½è²§é ¸èˆ‡å°æ‡‰è§£æ³•</p>
<ol>
<li><code>æ¯æ¬¡å­˜ç³»çµ±è®€å–è³‡æ–™å¾ˆæ²’æ•ˆç‡</code>:<br>
åƒ…éœ€è¦å†ç³»çµ±å•Ÿå‹•æ™‚è®€å–ä¸€æ¬¡é€² memory å³å¯ï¼Œå‡è¨­ç³»çµ±æ²’æœ‰ç©©å®šå„²å­˜ç©ºé–“ï¼Œå‰‡æ¯æ¬¡éƒ½è¦éš¨æ©Ÿç”¢ç”Ÿ clock_seqï¼Œé€™æœƒå°è‡´ç¢°æ’æ©Ÿç‡å¢åŠ ï¼Œæ‡‰è©²è¦ç›¡é‡é¿å…ï¼›å¦‚æœç¢ºå®š node id éƒ½ä¸æœƒè®Šï¼Œä¹Ÿå¯ä»¥ä¸ç”¨ä¿å­˜ç›´æ¥è¿”å›å³å¯</li>
<li><code>system clock ç²’åº¦ä¸è¦‹å¾—æœ‰åˆ° 100-nanoseconds</code>:<br>
System Clock Resolutionï¼šå¦‚æœç”¢ç”Ÿé »æ¬¡ä¸é«˜ï¼Œå‰‡ç›´æ¥å°‡ç³»çµ±æ™‚é–“æ”¾å¤§åˆ° 100-nano çš„ç²’åº¦å³å¯ï¼Œä½†å¦‚æœç³»çµ±å–®ä¸€æ™‚é–“ç”¢ç”Ÿéå¤š uuidï¼Œå¯¦ä½œå¿…é ˆè¿”å›éŒ¯èª¤ï¼Œæˆ–æ˜¯æš«åœç”¢ç”Ÿï¼Œç›´åˆ°ç³»çµ±æ™‚é–“æ­£å¸¸ï¼Œå¦‚æœè¦æé«˜ç²’åº¦ï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨åŒä¸€å€‹ç³»çµ±æ™‚é–“å…§ç´¯è¨ˆç”¢ç”Ÿçš„ uuid å€‹æ•¸ï¼Œ</li>
<li><code>æ¯æ¬¡è¦å›å¯«ç³»çµ±è³‡æ–™å¾ˆæ²’æ•ˆç‡</code><br>
åªéœ€è¦å®šæ™‚æ›´æ–°å„²å­˜è³‡æ–™å³å¯ï¼Œå°‡ timestamp è¨­å®šåœ¨æ¯”è‡³ä»Šç”¢ç”Ÿçš„ UUID ä½¿ç”¨çš„ timestamp å¤§ä¸€é»ï¼Œä½†åˆä¸è¦å¤§åˆ°è¶…é reboot æ™‚çš„æ‰€éœ€è¦çš„å•Ÿå‹•æ™‚é–“ï¼Œç›®çš„åœ¨æ–¼é™ä½ clock sequence é‡ç½®çš„æ©Ÿæœƒï¼Œåœ¨ä¸‹æ–¹çš„å»ºè­°å¯¦ä½œä¸­æ˜¯æ¯ 10 ç§’å¯«å…¥ä¸€æ¬¡</li>
</ol>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">   <span style="color:#719e07">if</span> (timestamp <span style="color:#719e07">&gt;=</span> next_save) {
      fp <span style="color:#719e07">=</span> fopen(<span style="color:#2aa198">&#34;state&#34;</span>, <span style="color:#2aa198">&#34;wb&#34;</span>);
      fwrite(<span style="color:#719e07">&amp;</span>st, <span style="color:#719e07">sizeof</span> st, <span style="color:#2aa198">1</span>, fp);
      fclose(fp);
      <span style="color:#586e75">/* schedule next save for 10 seconds from now */</span>
      next_save <span style="color:#719e07">=</span> timestamp <span style="color:#719e07">+</span> (<span style="color:#2aa198">10</span> <span style="color:#719e07">*</span> <span style="color:#2aa198">10</span> <span style="color:#719e07">*</span> <span style="color:#2aa198">1000</span> <span style="color:#719e07">*</span> <span style="color:#2aa198">1000</span>);
  }
</code></pre></div><ol start="4">
<li><code>è·¨é€²ç¨‹åˆ†äº«ç‹€æ…‹å¾ˆæ²’æ•ˆç‡</code><br>
å¦‚æœè·¨é€²ç¨‹å…±äº«ç‹€æ…‹å¾ˆè€—è³‡æºï¼Œå¯ä»¥æ¯å€‹é€²ç¨‹åˆ‡å‰²ä¸€å¡Šæ™‚é–“å€æ®µå€‹åˆ¥ç”¢ç”Ÿ uuid ï¼Œç›´åˆ°æ™‚é–“å€æ®µç”¨å®Œæ‰å»è¦æ–°çš„</li>
</ol>
<h3 id="43--algorithm-for-creating-a-name-based-uuid">4.3.  Algorithm for Creating a Name-Based UUID</h3>
<p>v3 è·Ÿ v5 ä¸»è¦æ˜¯åœ¨æŸä¸€ç‰¹å®šçš„ Namespace ä¸‹é‡å° Name ç”¢ç”Ÿå°æ‡‰çš„ UUIDï¼Œæœ‰ä»¥ä¸‹ç‰¹æ€§</p>
<ol>
<li>ç›¸åŒçš„ namespace ç›¸åŒçš„ nameï¼Œä¸åŒç³»çµ±æ™‚é–“ä¸€æ¨£æœ‰ç›¸åŒçš„ uuid</li>
<li>ç›¸åŒ namespace ä¸‹ä¸åŒ nameï¼Œuuid ä¸åŒ</li>
<li>ç›¸åŒ name ä¸åŒ namespaceï¼Œuuid ä¸åŒ</li>
<li>å¦‚æœå…©å€‹ uuid ç›¸åŒï¼Œå‰‡ä»£è¡¨ namespace / name ç›¸åŒ</li>
</ol>
<p>UUID æ¬„ä½å‰‡æ˜¯é€é Name + Namespace é›œæ¹Šå¾Œçš„å€¼å»æ´¾ç™¼</p>
<h3 id="45--node-ids-that-do-not-identify-the-host">4.5.  Node IDs that Do Not Identify the Host</h3>
<p>å¦‚æœ MAC Address ä¸èƒ½ä½¿ç”¨ï¼Œæœ‰å¹¾ç¨®åšæ³•èƒ½ä¿è­‰ Node ID çš„ç¨ä¸€æ€§</p>
<ol>
<li>å»è·Ÿ IEEE è²è«‹ç¨ç«‹å€æ®µçš„ä½å€ï¼Œåœ¨æ–‡ä»¶ç·¨å¯«æ™‚æœŸåƒ¹æ ¼æ˜¯ US$550</li>
<li>ä½¿ç”¨å¯†ç¢¼å­¸å¼·åº¦çš„éš¨æ©Ÿç¢¼å–æœ€ä½ä½ 47 bitï¼Œæœ€é«˜ bit è¨­å®šç‚º 1ï¼Œä¸»è¦æ˜¯é¿é–‹ IEEE ä¸­ MAC Address çš„å€æ®µ
<blockquote>
<p>å¸¸è¦‹åšæ³•æ˜¯åœ¨ buffer ä¸­éš¨æ©Ÿç´¯ç©ä¸€æ®µè³‡æ–™ï¼Œæ¥è‘—ç”¨ SHA1 æˆ– MD5 å– 48 bitsï¼Œç„¶å¾ŒæŠŠæœ€é«˜ bit è¨­å®šç‚º 1</p>
</blockquote>
</li>
</ol>
<h3 id="6--security-considerations">6.  Security Considerations</h3>
<p>UUID ä¸¦ä¸ä¿è­‰éš¨æ©Ÿæ€§ï¼Œæ‰€ä»¥ä¸æœƒå¾ˆé›£çŒœï¼Œæ‰€ä»¥ä¸èƒ½æ‹¿ä¾†åšè·Ÿå®‰å…¨æ€§æœ‰é—œçš„æ¥­å‹™</p>
<blockquote>
<p>Do not assume that UUIDs are hard to guess</p>
</blockquote>
<p>ä»¥ä¸Šå¤§æ¦‚æŒ‘å€‹é‡é»å¸¶é</p>
<h2 id="uuidjs-å¯¦ä½œæ‹†è§£">uuid.js å¯¦ä½œæ‹†è§£</h2>
<p>ä»¥ä¸‹å°‡é–±è®€<a href="https://github.com/uuidjs/uuid">uuid.js github repo</a>çš„åŸå§‹ç¢¼ï¼Œåœ¨é–‹å§‹çœ‹ v1~v5 çš„å¯¦ä½œå‰ï¼Œå…ˆçœ‹ä¸€å€‹ç”¨æ–¼ç”¢ç”Ÿéš¨æ©Ÿæ•¸çš„é‡è¦å‡½å¼  <a href="https://github.com/uuidjs/uuid/blob/master/src/rng.js">rng.js</a></p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#268bd2">import</span> crypto from <span style="color:#2aa198">&#39;crypto&#39;</span>;
<span style="color:#268bd2">const</span> rnds8Pool <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> Uint8Array(<span style="color:#2aa198">256</span>); <span style="color:#586e75">// # of random values to pre-allocate
</span><span style="color:#586e75"></span><span style="color:#268bd2">let</span> poolPtr <span style="color:#719e07">=</span> rnds8Pool.length;
<span style="color:#268bd2">export</span> <span style="color:#719e07">default</span> <span style="color:#268bd2">function</span> rng() {
  <span style="color:#719e07">if</span> (poolPtr <span style="color:#719e07">&gt;</span> rnds8Pool.length <span style="color:#719e07">-</span> <span style="color:#2aa198">16</span>) {
    crypto.randomFillSync(rnds8Pool);
    poolPtr <span style="color:#719e07">=</span> <span style="color:#2aa198">0</span>;
  }
  <span style="color:#719e07">return</span> rnds8Pool.slice(poolPtr, (poolPtr <span style="color:#719e07">+=</span> <span style="color:#2aa198">16</span>));
}
</code></pre></div><p>ç¨‹å¼ç¢¼å¾ˆçŸ­ï¼Œä¸»è¦å°±æ˜¯ç”¢ç”Ÿä¸€å€‹ rnds8Pool é™£åˆ—ï¼Œéš¨æ©Ÿå¡å…¥æ•¸å€¼ï¼Œæœ€å¾Œæ¯æ¬¡å›å‚³ 16 bitï¼Œå¦‚æœé€™ä¸€æ®µ rnds8Pool éƒ½å›å‚³äº†ï¼Œå°±åœ¨ä¸€æ¬¡ç”¢ç”Ÿæ–°çš„éš¨æ©Ÿäº‚æ•¸</p>
<p>é€™å¯ä»¥ä¿è­‰ç”¢ç”Ÿ <code>Generates cryptographically strong pseudo-random data.</code>ï¼Œä¾†è‡ª Nodejs å®˜æ–¹æ–‡ä»¶çš„ä¿è­‰ï¼Œä¹Ÿæ˜¯ uuid ä¸æœƒæœ‰é«˜ç¢°æ’æ©Ÿç‡çš„ä¿è­‰ï¼Œåˆ‡è¨˜ Math.random ä¸è¶³å¤ éš¨æ©Ÿï¼Œæ‹¿ä¾†ä½¿ç”¨å•é¡Œæœƒå¾ˆå¤š</p>
<h3 id="uuid-v1-å¯¦ä½œ">UUID v1 å¯¦ä½œ</h3>
<p>ä»¥ä¸‹æŒ‘é‡é»èªªï¼Œä¸å¾—ä¸èªªä½œè€…çš„ç¨‹å¼ç¢¼ä»¥åŠè¨»è§£å¯«å¾—å¾ˆä¹¾æ·¨ï¼Œç›´æ¥æ¨™æ˜å¯¦ä½œå°æ‡‰çš„ RFC æ®µè½</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#268bd2">const</span> seedBytes <span style="color:#719e07">=</span> options.random <span style="color:#719e07">||</span> (options.rng <span style="color:#719e07">||</span> rng)();
</code></pre></div><p>å…ˆç”¢ç”Ÿéš¨æ©Ÿæ•¸å‚™ç”¨ï¼Œåœ¨å‰é¢æ–‡ä»¶ä»‹ç´¹ä¸­ï¼Œæœ‰ç”¨åˆ°éš¨æ©Ÿç”¢ç”Ÿçš„éƒ½æœƒå¾ seedBytes ä¸­æå–</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#719e07">if</span> (node <span style="color:#719e07">==</span> <span style="color:#cb4b16">null</span>) {
  <span style="color:#586e75">// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)
</span><span style="color:#586e75"></span>  node <span style="color:#719e07">=</span> _nodeId <span style="color:#719e07">=</span> [
    seedBytes[<span style="color:#2aa198">0</span>] <span style="color:#719e07">|</span> <span style="color:#2aa198">0x01</span>,
    seedBytes[<span style="color:#2aa198">1</span>],
    seedBytes[<span style="color:#2aa198">2</span>],
    seedBytes[<span style="color:#2aa198">3</span>],
    seedBytes[<span style="color:#2aa198">4</span>],
    seedBytes[<span style="color:#2aa198">5</span>],
  ];
}
</code></pre></div><p>é€™è£¡å¯ä»¥çœ‹åˆ°ï¼Œå¯¦ä½œä¸­çš„ <code>node_idæ˜¯æ¯æ¬¡å•Ÿå‹•æ™‚éš¨æ©Ÿç”¢ç”Ÿ</code>ï¼Œé€™ç¬¦åˆæ–‡ä»¶ 4.1.6ï¼Œæ²’æœ‰æ¡ç”¨ MAC Address è‡ªå·±äº‚æ•¸ç”¢ç”Ÿä¹Ÿå¯ä»¥ï¼›<br>
åŒæ™‚é€™ä¸€æ®µæˆ‘æœ‰ç‰¹åˆ¥ç•™ä¸€å€‹ Issue è©¢å•ä½œè€…ï¼Œç‚ºä»€éº¼ä¸ç…§æ–‡ä»¶è¦ç¯„å»æ‹¿æ©Ÿå™¨çš„ MAC Addressï¼Œä»–å›ç­”åˆ°<code>åŸºæ–¼éš±ç§å•é¡Œ</code>ï¼Œè€Œä¸”å¦‚æœ Node ID è·Ÿ Clock Seq æ¯æ¬¡éƒ½éš¨æ©Ÿç”¢ç”Ÿä¹Ÿæ˜¯ç¬¦åˆæ–‡ä»¶è¦ç¯„çš„</p>
<blockquote>
<p>I believe that this comes close to the idea of the spec while avoiding the privacy problems that come with trying to derive a stable node ID from hardware.</p>
</blockquote>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#719e07">if</span> (clockseq <span style="color:#719e07">==</span> <span style="color:#cb4b16">null</span>) {
  <span style="color:#586e75">// Per 4.2.2, randomize (14 bit) clockseq
</span><span style="color:#586e75"></span>  clockseq <span style="color:#719e07">=</span> _clockseq <span style="color:#719e07">=</span> ((seedBytes[<span style="color:#2aa198">6</span>] <span style="color:#719e07">&lt;&lt;</span> <span style="color:#2aa198">8</span>) <span style="color:#719e07">|</span> seedBytes[<span style="color:#2aa198">7</span>]) <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0x3fff</span>;
}
</code></pre></div><p>æ²’æœ‰ clockseq å°±äº‚æ•¸ç”¢ç”Ÿ</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#586e75">// Per 4.2.1.2 Throw error if too many uuids are requested
</span><span style="color:#586e75"></span><span style="color:#719e07">if</span> (nsecs <span style="color:#719e07">&gt;=</span> <span style="color:#2aa198">10000</span>) {
  <span style="color:#719e07">throw</span> <span style="color:#719e07">new</span> <span style="color:#b58900">Error</span>(<span style="color:#2aa198">&#34;uuid.v1(): Can&#39;t create more than 10M uuids/sec&#34;</span>);
}
</code></pre></div><p>å¦‚æœå¯¦ä½œè€…ç™¼ç¾çŸ­æ™‚é–“å…§æœ‰å¤ªå¤§é‡çš„ uuid ç”¢ç”Ÿï¼Œéœ€è¦æ‹‹å‡ºéŒ¯èª¤æˆ–æ˜¯æš«åœ uuid ç”Ÿæˆé¿å…ç¢°æ’</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#586e75">// `time_low`
</span><span style="color:#586e75"></span><span style="color:#268bd2">const</span> tl <span style="color:#719e07">=</span> ((msecs <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0xfffffff</span>) <span style="color:#719e07">*</span> <span style="color:#2aa198">10000</span> <span style="color:#719e07">+</span> nsecs) <span style="color:#719e07">%</span> <span style="color:#2aa198">0x100000000</span>;
b[i<span style="color:#719e07">++</span>] <span style="color:#719e07">=</span> (tl <span style="color:#719e07">&gt;&gt;&gt;</span> <span style="color:#2aa198">24</span>) <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0xff</span>;
b[i<span style="color:#719e07">++</span>] <span style="color:#719e07">=</span> (tl <span style="color:#719e07">&gt;&gt;&gt;</span> <span style="color:#2aa198">16</span>) <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0xff</span>;
b[i<span style="color:#719e07">++</span>] <span style="color:#719e07">=</span> (tl <span style="color:#719e07">&gt;&gt;&gt;</span> <span style="color:#2aa198">8</span>) <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0xff</span>;
b[i<span style="color:#719e07">++</span>] <span style="color:#719e07">=</span> tl <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0xff</span>;
<span style="color:#586e75">// `time_mid`
</span><span style="color:#586e75"></span><span style="color:#268bd2">const</span> tmh <span style="color:#719e07">=</span> ((msecs <span style="color:#719e07">/</span> <span style="color:#2aa198">0x100000000</span>) <span style="color:#719e07">*</span> <span style="color:#2aa198">10000</span>) <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0xfffffff</span>;
b[i<span style="color:#719e07">++</span>] <span style="color:#719e07">=</span> (tmh <span style="color:#719e07">&gt;&gt;&gt;</span> <span style="color:#2aa198">8</span>) <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0xff</span>;
b[i<span style="color:#719e07">++</span>] <span style="color:#719e07">=</span> tmh <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0xff</span>;
<span style="color:#586e75">// `time_high_and_version`
</span><span style="color:#586e75"></span>b[i<span style="color:#719e07">++</span>] <span style="color:#719e07">=</span> ((tmh <span style="color:#719e07">&gt;&gt;&gt;</span> <span style="color:#2aa198">24</span>) <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0xf</span>) <span style="color:#719e07">|</span> <span style="color:#2aa198">0x10</span>; <span style="color:#586e75">// include version
</span><span style="color:#586e75"></span>b[i<span style="color:#719e07">++</span>] <span style="color:#719e07">=</span> (tmh <span style="color:#719e07">&gt;&gt;&gt;</span> <span style="color:#2aa198">16</span>) <span style="color:#719e07">&amp;</span> <span style="color:#2aa198">0xff</span>;
</code></pre></div><p>ç”¢ç”Ÿ time ç›¸é—œæ¬„ä½</p>
<p>v4 å¯¦ä½œç›¸ç•¶ç°¡å–®ï¼Œå°±æ˜¯ä¿ç•™ versionï¼Œå…¶é¤˜å¡éš¨æ©Ÿæ•¸ï¼›
v3,v5 å¤§åŒå°ç•°ï¼Œæ‰€ä»¥ä½œè€…å¯«äº†ä¸€å€‹ v35.js ï¼Œé‡é»å¤§æ¦‚å°±é€™éº¼å¹¾è¡Œ</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#586e75">// Compute hash of namespace and value, Per 4.3
</span><span style="color:#586e75">// Future: Use spread syntax when supported on all platforms, e.g. `bytes =
</span><span style="color:#586e75">// hashfunc([...namespace, ... value])`
</span><span style="color:#586e75"></span><span style="color:#268bd2">let</span> bytes <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> Uint8Array(<span style="color:#2aa198">16</span> <span style="color:#719e07">+</span> value.length);
bytes.set(namespace);
bytes.set(value, namespace.length);
bytes <span style="color:#719e07">=</span> hashfunc(bytes);
</code></pre></div><p>æŠŠ namespace è·Ÿ value åˆèµ·ä¾†ç„¶å¾Œ hash éï¼Œæ¥è‘—å°±æŒ‰ç…§æ–‡ä»¶å¡åˆ°å°æ‡‰çš„ä½ç½®</p>
<h2 id="å¾Œè¨˜ä½œè€…æäº¤-proposal-çµ¦-tc39">å¾Œè¨˜ï¼šä½œè€…æäº¤ proposal çµ¦ tc39</h2>
<p>ä½œè€…åœ¨ PR ä¸­æœ‰èªªåˆ°ä»–æäº†ä¸€å€‹ proposal çµ¦ tc39 <a href="https://github.com/tc39/proposal-uuid#arent-v1-uuids-better-because-they-are-guaranteed-to-be-unique">proposal-uuid</a>ï¼Œç›®å‰é‚„åœ¨ stage 0ï¼Œå¸Œæœ›æŠŠ uuid ç”¢ç”Ÿè®Šæˆ js çš„è¦ç¯„ï¼Œä¸»è¦æ˜¯æœ‰å¤ªå¤šéŒ¯èª¤ä¸”ç²—å¿ƒçš„å¯¦ä½œï¼Œä¾‹å¦‚ä½¿ç”¨ Math.random ç­‰ï¼Œé€™é‚Šå¼•ç”¨ä¸€ç¯‡éå¸¸æ£’çš„æ–‡ç« æŒ‡å‡ºç‚ºä»€éº¼ Math.random ä¸å¥½ <a href="https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d">TIFU by using Math.random()</a>ï¼Œä»¥ä¸‹å°‡æ‘˜éŒ„é‡é»</p>
<h3 id="tifu-by-using-mathrandom-æ–‡ç« é‡é»æ‘˜è¦">TIFU by using Math.random() æ–‡ç« é‡é»æ‘˜è¦</h3>
<blockquote>
<p>TIFU =&gt; Today I Fucked Up</p>
</blockquote>
<p>ä½œè€…å…¬å¸æ¡ç”¨ microserviceï¼Œä½†ä»–å€‘å¸Œæœ›å¯ä»¥è¿½è¹¤æ¯å€‹ request åœ¨ service ä¸­äº¤äº’çµæœï¼Œæ‰€ä»¥éœ€è¦æœ‰ä¸€å€‹å…¨åŸŸçš„ request idï¼Œéœ€è¦ä¸€å€‹éš¨æ©Ÿç”Ÿæˆæ¼”ç®—æ³•ç”¢ç”Ÿè¶³å¤ éš¨æ©Ÿçš„ id</p>
<p>æ‰€è¬‚çš„è¶³å¤ éš¨æ©ŸåŒ…å«å…©é»</p>
<ol>
<li>è¶³å¤ å¤§çš„ identifier spaceï¼šæœ‰è¶³å¤ å¤šçš„çµ„åˆèˆ‡å¯èƒ½æ€§</li>
<li>è¶³å¤ éš¨æ©Ÿçš„ identifier generationï¼šæœ‰äº†è¶³å¤ å¤šçš„ identifier spaceï¼Œé‚„éœ€è¦è¶³å¤ éš¨æ©Ÿçš„ç”Ÿæˆæ©Ÿåˆ¶</li>
</ol>
<p>ä½œè€…æ±ºå®šç”¨é•·åº¦ 22 çš„ base 64ï¼Œä¹Ÿå°±æ˜¯ space æœ‰ 64^22 é€™éº¼å¤§ï¼Œgeneration å‰‡æ˜¯ç”¨ decent pseudo-random number generator (PRNG) å¸¸è¦‹çš„æ¼”ç®—æ³•ï¼ŒV8 å³æ˜¯æ¡ç”¨é€™ä¸€å¥—ï¼Œå¦‚æœè¶³å¤ éš¨æ©Ÿï¼Œé‚£é€™æ¨£çš„ç©ºé–“è¶³ä»¥<code>é è¨ˆæ¯ç§’ç”¢ç”Ÿä¸€ç™¾è¬æ¬¡ä¹Ÿè¦ä¸‰ç™¾å¹´æ‰æœƒç¢°æ’</code>ï¼Œå¤šéº¼çš„ç¾å¥½</p>
<p>æœ€å¾Œä½œè€…å…œå‡ºä¾†çš„ç¨‹å¼ç¢¼å¦‚ä¸‹</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#268bd2">var</span> ALPHABET <span style="color:#719e07">=</span> <span style="color:#2aa198">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_&#39;</span>;
random_base64 <span style="color:#719e07">=</span> <span style="color:#268bd2">function</span> random_base64(length) {
    <span style="color:#268bd2">var</span> str <span style="color:#719e07">=</span> <span style="color:#2aa198">&#34;&#34;</span>;
    <span style="color:#719e07">for</span> (<span style="color:#268bd2">var</span> i<span style="color:#719e07">=</span><span style="color:#2aa198">0</span>; i <span style="color:#719e07">&lt;</span> length; <span style="color:#719e07">++</span>i) {
        <span style="color:#268bd2">var</span> rand <span style="color:#719e07">=</span> <span style="color:#b58900">Math</span>.floor(<span style="color:#b58900">Math</span>.random() <span style="color:#719e07">*</span> ALPHABET.length);
        str <span style="color:#719e07">+=</span> ALPHABET.substring(rand, rand<span style="color:#719e07">+</span><span style="color:#2aa198">1</span>);
    }
    <span style="color:#719e07">return</span> str;
}
</code></pre></div><p>çœ‹èµ·ä¾†ä¸€é»å•é¡Œéƒ½æ²’æœ‰ï¼Œä¹Ÿæ˜¯å¤§å®¶å¸¸è¦‹çš„éš¨æ©Ÿç”Ÿæˆåšæ³•</p>
<p>ä½†æ˜¯åœ¨ä¸ä¹…å¾ŒåŒäº‹ç™¼ç¾ ID ç¢°æ’äº† ğŸ’¥</p>
<blockquote>
<p>â€œAnyone who considers arithmetical methods of producing random digits is, of course, in a state of sin.â€ From John von Neumann
æ„å³è¦é€éæ•¸å­¸æ–¹å¼ç”¢ç”ŸçœŸæ­£éš¨æ©Ÿæ ¹æœ¬æ˜¯ä¸å¯èƒ½</p>
</blockquote>
<h4 id="prng-å¯¦ä½œ">PRNG å¯¦ä½œ</h4>
<p>ç°¡å–®çœ‹ä¸€ä¸‹å½éš¨æ©Ÿæ•¸çš„ç”Ÿæˆæ–¹å¼ä¹‹ä¸€ PRNG (pseudo random number generator)
<img src="https://miro.medium.com/max/700/1*_rpSUn6ekuZvXJnT5bWUbw.png" alt="">
ä¾†è‡ªåŸæ–‡çš„åœ–ç‰‡</p>
<p>ç°¡å–®ä¾†èªªå°±æ˜¯æœƒæœ‰ä¸€å€‹åˆå§‹çš„ Seedï¼Œæ¥è‘—æŒ‰ç…§æ•¸å­¸å…¬å¼ç®—å‡ºä¸€å€‹å°æ‡‰çš„ä½ç½®ï¼Œæ‰€ä»¥åªæœ‰ç¶“éå¹¾æ¬¡è¼ªè½‰ï¼Œæ‰€ä»¥è¦ç”¨ finite state ç”¢ç”Ÿéš¨æ©Ÿæ•¸æ˜¯ä¸å¯èƒ½çš„ï¼Œåªè¦ PRNG æŒçºŒç”¢ç”Ÿï¼Œé‚£æœ€çµ‚è¼¸å‡ºæœƒé‡è¤‡å‡ºç¾ <code>Periodic</code>ï¼Œä½œè€…æ¯”é‡åˆ°ï¼Œ PRNG å°±åƒä¸€æœ¬å£“ç¸®çš„å¯†ç¢¼æœ¬æœ¬åŒ…å«è‘—ä¸€ä¸²æ•¸å­—ï¼ŒSeed åƒæ˜¯ä½ æŒ‘æŸä¸€é é–‹å§‹çœ‹ï¼Œæ¥è‘—ä¸€è·¯å¾€ä¸‹ç¿»ï¼Œåˆ°æ›¸å°¾å†å¾æ›¸é¦–é–‹å§‹çœ‹èµ·ï¼Œçµ‚å°‡è¼ªè¿´</p>
<p>ä¸éåªè¦ Cycle çš„é•·åº¦é•·åˆ°åœ¨æœ‰é™æ™‚é–“å…§ä¸æœƒç™¼ç”Ÿå³å¯ï¼Œé€™ä¹Ÿæ±ºå®š PRNG æ¼”ç®—æ³•å“è³ªï¼Œç¨±ä¹‹ç‚º <code>full-cycle generator</code></p>
<blockquote>
<p>If a PRNGâ€™s state has a k-bit representation, the cycle length is less than or equal to 2áµ. A PRNG that actually achieves this maximum cycle length is called a full-cycle generator.</p>
</blockquote>
<p>è‰¯å¥½çš„ PRNG æœƒç›¡å¯èƒ½é”åˆ° 2áµ ä¸Šé™</p>
<p>å¾Œé¢æœ‰ä¸€æ®µå†èªªæ˜ Chrome ç•¶æ™‚çš„ Math.random æ¼”ç®—æ³•éŒ¯èª¤ï¼Œæ‰€ä»¥å¯¦éš›ä¸Š 590 million å°±æœƒç™¼ç”Ÿå¾ªç’°ï¼Œæ›´ç³Ÿç³•çš„æ˜¯åŸºæ–¼ç”Ÿæ—¥æ‚–è«–ï¼Œç”¢ç”Ÿåƒ…åƒ… 3 è¬æ¬¡å°±æœƒæœ‰ 50% çš„ç¢°æ’æ©Ÿæœƒ (50% chance of collision after generating just 30,000 identifiers.)</p>
<p>æœ€å¾Œçš„çµè«–æ˜¯å¦‚æœè¦<code>æ¡ç”¨å½éš¨æ©Ÿç”Ÿæˆæ•¸è«‹ç”¨ CSPRNG(cryptographically secure PRNG)</code>ï¼Œæˆ–æ˜¯æ¡ç”¨ç³»çµ±æ ¸å¿ƒåŸºæ–¼å¤–éƒ¨å™ªéŸ³ã€ç¶²è·¯å°åŒ…ç­‰ç”¢ç”Ÿçš„çœŸéš¨æ©Ÿæ•¸ <code>urandom</code></p>
<h2 id="å…¶ä»–">å…¶ä»–</h2>
<p>ä»Šå¤©è·¯éçœ‹åˆ°ä¸€ç¯‡é—œæ–¼ UUID çš„å¥½æ–‡ <a href="https://medium.com/%E9%96%92%E8%AB%87%E8%BB%9F%E9%AB%94%E6%9E%B6%E6%A7%8B/%E9%96%92%E8%AB%87%E8%BB%9F%E9%AB%94%E6%9E%B6%E6%A7%8B-uuid-2748df80aa7e">é–’è«‡è»Ÿé«”æ¶æ§‹ï¼šUUID</a>ï¼Œä¸»è¦æ›´æ·±å…¥æ¢è¨å¦‚æœæŠŠ UUID ç•¶ä½œè³‡æ–™åº«çš„ Key å°æ–¼æ•ˆèƒ½çš„å½±éŸ¿ï¼Œä¸»ç›®çš„æ˜¯å¸Œæœ›èƒ½é”åˆ° <code>åˆ†æ•£å¼ç”¢ç”Ÿéå¢çš„ Key</code>ï¼ŒUUID v1 ç®—æ˜¯æœ‰ç¬¦åˆé€™å€‹è¦æ±‚ï¼Œä½†å› ç‚ºæœ‰åšé timestamp çš„æ‹†åˆ†ï¼Œå°è‡´ Java å¯¦ä½œåœ¨æ¯”å°æ™‚æœƒæœ‰é»å•é¡Œ<br>
å¯ä»¥è‡ªå·±å®¢è£½åŒ– UUID çš„æ ¼å¼ï¼Œæˆ–ä¹¾è„†è‡ªå‰µï¼Œåƒè€ƒå…¶ä»–å¯¦ä½œå¦‚ Twitter Snowflake(å·² deprecated) æˆ–æ˜¯ <a href="https://firebase.googleblog.com/2015/02/the-2120-ways-to-ensure-unique_68.html">Firebase Push ID</a>ï¼Œå¤§æŠµä¸Šéƒ½è„«é›¢ä¸äº† <code>timestamp åŠ ä¸Šäº‚æ•¸æˆ–æ˜¯åŠ ä¸Šæ©Ÿå™¨è­˜åˆ¥ç¢¼</code>çš„åšæ³•</p>
<h2 id="çµè«–">çµè«–</h2>
<p>ID æ˜¯å¸¸ç”¨çš„å±¬æ€§ï¼Œç”¨ä¾†æŠ½è±¡åŒ–æŒ‡å‘æŸå€‹ç‰©ä»¶/äº‹ä»¶ï¼Œé¸æ“‡æ­£ç¢ºçš„æ–¹å¼ç”¢ç”Ÿ IDï¼Œæ‰ä¸æœƒå°æ–¼ç³»çµ±ç”¢ç”Ÿæ•ˆèƒ½è²§é ¸ï¼Œé€éå­¸ç¿’ UUID çš„å¯¦ä½œéç¨‹ï¼Œçœ‹åˆ°åˆ†æ•£å¼ç”¢ç”Ÿ ID çš„æ–¹å¼ï¼Œå°¤å…¶æ˜¯åœ¨å¤§æ•¸æ“šæ™‚ä»£ï¼Œå¿«é€Ÿç”¢ç”Ÿç¨ä¸€(ä¸”éå¢)çš„ ID å°¤ç‚ºåŸºç¤ä¸”é‡è¦ï¼Œè€Œåœ¨ä¹‹ä¸­<code>éš¨æ©Ÿæ€§</code>åœ¨æ•´å€‹éç¨‹æ‰®æ¼”è‘—å¾ˆé—œéµçš„è§’è‰²</p>

	</div>
	
	
	
	
	
	
	
	<div class="tags">
		<div class="taxosfloating_left">
			<p>Categories</p>
		</div>
		<div class="termsfloating_right">
			<p>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<a href="/categories/%e6%bc%94%e7%ae%97%e6%b3%95/"> æ¼”ç®—æ³• </a>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			</p>
		</div>
		<div class="clearit"></div>
		
		
		
		
	
		
	
		
		
	</div>
<div id="disqus_thread"></div>
<script type="text/javascript">
	(function() {
	    
	    
	    if (window.location.hostname == "localhost")
	        return;
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    var disqus_shortname = 'yuanchieh';
	    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to load the comments.</noscript>


</div>

  </main>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-82837682-4', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>




</body>
</html>
